{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.getElementById('search-form');\nconst gallery = document.querySelector('.gallery');\nconst observerOptions = {\n    rootMargin: '200px'\n};\n\nlet searchQuery = '';\nlet page = 1;\nconst perPage = 40;\nconst API_KEY = '44418416-01658c71a65aed4380a3ece44';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nlet lightbox; // Global instance for SimpleLightbox\n\nconst fetchImages = async (query, page) => {\n    try {\n        const response = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page: page,\n                per_page: perPage\n            }\n        });\n        return response.data;\n    } catch (error) {\n        console.error('Error fetching images:', error);\n        throw error;\n    }\n};\n\nconst renderImages = images => {\n    const markup = images.map(image => `\n        <a href=\"${image.largeImageURL}\" class=\"photo-card\">\n            <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n                <p class=\"info-item\"><b>Likes:</b> ${image.likes}</p>\n                <p class=\"info-item\"><b>Views:</b> ${image.views}</p>\n                <p class=\"info-item\"><b>Comments:</b> ${image.comments}</p>\n                <p class=\"info-item\"><b>Downloads:</b> ${image.downloads}</p>\n            </div>\n        </a>\n    `).join('');\n    gallery.insertAdjacentHTML('beforeend', markup);\n\n    // Initialize SimpleLightbox only once\n    if (!lightbox) {\n        lightbox = new SimpleLightbox('.gallery a', { captionDelay: 250 });\n    } else {\n        lightbox.refresh();\n    }\n};\n\nconst clearGallery = () => {\n    gallery.innerHTML = '';\n};\n\nconst handleSearch = async event => {\n    event.preventDefault();\n    searchQuery = event.currentTarget.elements.searchQuery.value.trim();\n    if (!searchQuery) {\n        iziToast.error({ title: 'Error', message: 'Please enter a search query.' });\n        return;\n    }\n    page = 1;\n    clearGallery();\n\n    try {\n        const data = await fetchImages(searchQuery, page);\n        if (data.hits.length === 0) {\n            iziToast.error({ title: 'Error', message: `No images found for \"${searchQuery}\". Please try again.` });\n            return;\n        }\n        renderImages(data.hits);\n        iziToast.success({ title: 'Success', message: `Found ${data.totalHits} images for \"${searchQuery}\".` });\n\n        if (data.hits.length === perPage) {\n            observeLastImageElement();\n        } else {\n            iziToast.info({ title: 'Info', message: 'End of images.' });\n        }\n    } catch (error) {\n        iziToast.error({ title: 'Error', message: 'Failed to fetch images. Please try again later.' });\n        console.error('Error fetching images:', error);\n    }\n};\n\nconst observeLastImageElement = () => {\n    const observer = new IntersectionObserver(async (entries, observer) => {\n        if (entries[0].isIntersecting) {\n            observer.unobserve(entries[0].target);\n\n            page += 1;\n            try {\n                const data = await fetchImages(searchQuery, page);\n                renderImages(data.hits);\n\n                if (page * perPage >= data.totalHits) {\n                    iziToast.info({ title: 'Info', message: \"You've reached the end of search results.\" });\n                } else {\n                    observeLastImageElement();\n                }\n            } catch (error) {\n                iziToast.error({ title: 'Error', message: 'Failed to fetch more images. Please try again later.' });\n                console.error('Error fetching more images:', error);\n            }\n        }\n    }, observerOptions);\n\n    observer.observe(gallery.lastElementChild);\n};\n\nlightbox = new SimpleLightbox('.gallery a', { captionDelay: 250 });\n\nform.addEventListener('submit', handleSearch);\n"],"names":["form","gallery","observerOptions","searchQuery","page","perPage","API_KEY","BASE_URL","lightbox","fetchImages","query","axios","error","renderImages","images","markup","image","SimpleLightbox","clearGallery","handleSearch","event","iziToast","data","observeLastImageElement","entries","observer"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAkB,CACpB,WAAY,OAChB,EAEA,IAAIC,EAAc,GACdC,EAAO,EACX,MAAMC,EAAU,GACVC,EAAU,qCACVC,EAAW,2BAEjB,IAAIC,EAEJ,MAAMC,EAAc,MAAOC,EAAON,IAAS,CACvC,GAAI,CAYA,OAXiB,MAAMO,EAAM,IAAIJ,EAAU,CACvC,OAAQ,CACJ,IAAKD,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMN,EACN,SAAUC,CACb,CACb,CAAS,GACe,IACnB,OAAQO,EAAO,CACZ,cAAQ,MAAM,yBAA0BA,CAAK,EACvCA,CACT,CACL,EAEMC,EAAeC,GAAU,CAC3B,MAAMC,EAASD,EAAO,IAAIE,GAAS;AAAA,mBACpBA,EAAM,aAAa;AAAA,wBACdA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,qDAETA,EAAM,KAAK;AAAA,qDACXA,EAAM,KAAK;AAAA,wDACRA,EAAM,QAAQ;AAAA,yDACbA,EAAM,SAAS;AAAA;AAAA;AAAA,KAGnE,EAAE,KAAK,EAAE,EACVf,EAAQ,mBAAmB,YAAac,CAAM,EAGzCP,EAGDA,EAAS,QAAO,EAFhBA,EAAW,IAAIS,EAAe,aAAc,CAAE,aAAc,GAAG,CAAE,CAIzE,EAEMC,EAAe,IAAM,CACvBjB,EAAQ,UAAY,EACxB,EAEMkB,EAAe,MAAMC,GAAS,CAGhC,GAFAA,EAAM,eAAc,EACpBjB,EAAciB,EAAM,cAAc,SAAS,YAAY,MAAM,OACzD,CAACjB,EAAa,CACdkB,EAAS,MAAM,CAAE,MAAO,QAAS,QAAS,8BAA8B,CAAE,EAC1E,MACH,CACDjB,EAAO,EACPc,IAEA,GAAI,CACA,MAAMI,EAAO,MAAMb,EAAYN,EAAaC,CAAI,EAChD,GAAIkB,EAAK,KAAK,SAAW,EAAG,CACxBD,EAAS,MAAM,CAAE,MAAO,QAAS,QAAS,wBAAwBlB,CAAW,sBAAsB,CAAE,EACrG,MACH,CACDU,EAAaS,EAAK,IAAI,EACtBD,EAAS,QAAQ,CAAE,MAAO,UAAW,QAAS,SAASC,EAAK,SAAS,gBAAgBnB,CAAW,IAAM,CAAA,EAElGmB,EAAK,KAAK,SAAWjB,EACrBkB,IAEAF,EAAS,KAAK,CAAE,MAAO,OAAQ,QAAS,gBAAgB,CAAE,CAEjE,OAAQT,EAAO,CACZS,EAAS,MAAM,CAAE,MAAO,QAAS,QAAS,iDAAiD,CAAE,EAC7F,QAAQ,MAAM,yBAA0BT,CAAK,CAChD,CACL,EAEMW,EAA0B,IAAM,CACjB,IAAI,qBAAqB,MAAOC,EAASC,IAAa,CACnE,GAAID,EAAQ,CAAC,EAAE,eAAgB,CAC3BC,EAAS,UAAUD,EAAQ,CAAC,EAAE,MAAM,EAEpCpB,GAAQ,EACR,GAAI,CACA,MAAMkB,EAAO,MAAMb,EAAYN,EAAaC,CAAI,EAChDS,EAAaS,EAAK,IAAI,EAElBlB,EAAOC,GAAWiB,EAAK,UACvBD,EAAS,KAAK,CAAE,MAAO,OAAQ,QAAS,2CAA2C,CAAE,EAErFE,GAEP,OAAQX,EAAO,CACZS,EAAS,MAAM,CAAE,MAAO,QAAS,QAAS,sDAAsD,CAAE,EAClG,QAAQ,MAAM,8BAA+BT,CAAK,CACrD,CACJ,CACJ,EAAEV,CAAe,EAET,QAAQD,EAAQ,gBAAgB,CAC7C,EAEAO,EAAW,IAAIS,EAAe,aAAc,CAAE,aAAc,GAAK,CAAA,EAEjEjB,EAAK,iBAAiB,SAAUmB,CAAY"}